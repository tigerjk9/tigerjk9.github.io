---
layout: null
---
{%- comment -%}
  모든 게시물에서 사용된 태그 목록을 수집합니다.
{%- endcomment -%}
{%- assign all_tags = "" | split: "," -%}
{%- for post in site.posts -%}
  {%- for tag in post.tags -%}
    {%- assign all_tags = all_tags | push: tag -%}
  {%- endfor -%}
{%- endfor -%}

{%- comment -%}
  중복을 제거하여 고유한 태그 목록만 남깁니다.
{%- endcomment -%}
{%- assign unique_tags = all_tags | uniq | sort -%}

{
  "nodes": [
    {%- comment -%}
      각 고유 태그가 전체 태그 목록에서 몇 번 나타나는지 계산합니다.
      이 부분이 오류를 해결하기 위해 수정된 부분입니다.
    {%- endcomment -%}
    {%- for tag in unique_tags -%}
      {%- assign count = 0 -%}
      {%- for t in all_tags -%}
        {%- if t == tag -%}
          {%- assign count = count | plus: 1 -%}
        {%- endif -%}
      {%- endfor -%}
      {
        "id": "{{ tag | escape }}",
        "label": "{{ tag | escape }}",
        "value": {{ count }}
      }
      {%- unless forloop.last -%},{%- endunless -%}
    {%- endfor -%}
  ],
  "edges": [
    {%- assign processed_edges = "" | split: "," -%}
    {%- for post in site.posts -%}
      {%- if post.tags.size > 1 -%}
        {%- assign post_tags_sorted = post.tags | sort -%}
        {%- for i in (0..post_tags_sorted.size-2) -%}
          {%- for j in (i+1..post_tags_sorted.size-1) -%}
            {%- assign tag1 = post_tags_sorted[i] -%}
            {%- assign tag2 = post_tags_sorted[j] -%}
            {%- assign edge_pair = tag1 | append: '--' | append: tag2 -%}
            {%- unless processed_edges contains edge_pair -%}
              {
                "from": "{{ tag1 | escape }}",
                "to": "{{ tag2 | escape }}"
              }
              {%- assign processed_edges = processed_edges | push: edge_pair -%},
            {%- endunless -%}
          {%- endfor -%}
        {%- endfor -%}
      {%- endif -%}
    {%- endfor -%}
    {}
  ]
}
