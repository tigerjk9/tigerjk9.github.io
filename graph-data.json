---
layout: null
---
{%- comment -%} 태그 전체 목록 수집 {%- endcomment -%}
{%- assign all_tags = "" | split: "," -%}
{%- for post in site.posts -%}
  {%- for tag in post.tags -%}
    {%- assign all_tags = all_tags | push: tag -%}
  {%- endfor -%}
{%- endfor -%}
{%- assign unique_tags = all_tags | uniq | sort -%}

{
  "nodes": [
    {%- comment %} 1. '게시물' 노드 생성 {%- endcomment -%}
    {%- assign post_nodes = "" | split: "||" -%}
    {%- for post in site.posts -%}
      {%- capture node_info -%}
        {
          "id": "{{ post.url | relative_url | escape }}",
          "label": "{{ post.title | escape }}",
          "group": "post",
          "value": 5
        }
      {%- endcapture -%}
      {%- assign post_nodes = post_nodes | push: node_info -%}
    {%- endfor -%},

    {%- comment %} 2. '태그' 노드 생성 {%- endcomment -%}
    {%- assign tag_nodes = "" | split: "||" -%}
    {%- for tag in unique_tags -%}
      {%- assign count = 0 -%}
      {%- for t in all_tags -%}
        {%- if t == tag -%}
          {%- assign count = count | plus: 1 -%}
        {%- endif -%}
      {%- endfor -%}
      {%- capture node_info -%}
        {
          "id": "{{ tag | escape }}",
          "label": "{{ tag | escape }}",
          "group": "tag",
          "value": {{ count | times: 5 | plus: 10 }}
        }
      {%- endcapture -%}
      {%- assign tag_nodes = tag_nodes | push: node_info -%}
    {%- endfor -%}
    {{ post_nodes | join: "," }}{{ tag_nodes | join: "," }}
  ],
  "edges": [
    {%- comment %} 3. '게시물-태그' 연결선 생성 {%- endcomment -%}
    {%- assign edge_list = "" | split: "||" -%}
    {%- for post in site.posts -%}
      {%- for tag in post.tags -%}
        {%- capture edge -%}
          { "from": "{{ post.url | relative_url | escape }}", "to": "{{ tag | escape }}" }
        {%- endcapture -%}
        {%- assign edge_list = edge_list | push: edge -%}
      {%- endfor -%}
    {%- endfor -%}
    {{ edge_list | join: "," }}
  ]
}
