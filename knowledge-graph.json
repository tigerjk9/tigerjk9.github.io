---
layout: null
---
{
  "nodes": [
    {% for post in site.posts %}
      {
        "id": "{{ post.url | relative_url }}",
        "label": "{{ post.title | escape }}",
        "group": "{{ post.categories.first | default: 'default' }}",
        "url": "{{ post.url | relative_url }}",
        "tags": {{ post.tags | jsonify }}
      }{% unless forloop.last %},{% endunless %}
    {% endfor %}
  ],
  "edges": [
    {%- assign edges = "" -%}
    {% for post1 in site.posts %}
      {% for post2 in site.posts %}
        {% if post1.url < post2.url %}
          {% assign common_tags = post1.tags | intersperse: ',' | join: ',' | split: ',' | uniq | where_exp: "item", "post2.tags contains item" %}
          {% assign common_tag_count = common_tags | size %}

          {% if common_tag_count > 0 %}
            {%- capture edge_json -%}
              {
                "from": "{{ post1.url | relative_url }}",
                "to": "{{ post2.url | relative_url }}",
                "value": {{ common_tag_count }}
              }
            {%- endcapture -%}
            {%- assign edges = edges | append: edge_json | append: "," -%}
          {% endif %}
        {% endif %}
      {% endfor %}
    {% endfor %}
    {{ edges | remove_last: "," }}
  ]
}
