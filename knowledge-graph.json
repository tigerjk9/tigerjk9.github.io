---
layout: null
---
{
  "nodes": [
    {%- for post in site.posts -%}
      {
        "id": "{{ post.url | relative_url | escape }}",
        "label": "{{ post.title | escape }}",
        "group": "{{ post.categories.first | default: 'default' }}",
        "url": "{{ post.url | relative_url | escape }}"
      }{%- unless forloop.last -%},{%- endunless -%}
    {%- endfor -%}
  ],
  "edges": [
    {%- assign edge_list = "" | split: "||" -%}
    {%- for post1 in site.posts -%}
      {%- for post2 in site.posts -%}
        {%- if post1.url < post2.url -%}
          {%- assign common_tag_count = 0 -%}
          {%- for tag1 in post1.tags -%}
            {%- if post2.tags contains tag1 -%}
              {%- assign common_tag_count = common_tag_count | plus: 1 -%}
            {%- endif -%}
          {%- endfor -%}

          {%- if common_tag_count > 0 -%}
            {%- capture edge_json -%}
              {
                "from": "{{ post1.url | relative_url | escape }}",
                "to": "{{ post2.url | relative_url | escape }}",
                "value": {{ common_tag_count }}
              }
            {%- endcapture -%}
            {%- assign edge_list = edge_list | push: edge_json -%}
          {%- endif -%}
        {%- endif -%}
      {%- endfor -%}
    {%- endfor -%}
    {{ edge_list | join: "," }}
  ]
}
