---
layout: null
---
{
  "nodes": [
    {%- assign nodes_array = "" | split: "" -%}
    {%- for post in site.posts -%}
      {%- capture node_json -%}
        {
          "id": {{ post.url | relative_url | jsonify }},
          "label": {{ post.title | jsonify }},
          "group": {{ post.categories.first | default: 'default' | jsonify }},
          "url": {{ post.url | relative_url | jsonify }},
          "tags": {{ post.tags | jsonify }}
        }
      {%- endcapture -%}
      {%- assign nodes_array = nodes_array | push: node_json -%}
    {%- endfor -%}
    {{ nodes_array | join: "," }}
  ],
  "edges": [
    {%- assign edges_list = "" -%}
    {% for post1 in site.posts %}
      {% for post2 in site.posts %}
        {% if post1.url < post2.url %}

          {%- assign common_tag_count = 0 -%}
          {% for tag1 in post1.tags %}
            {% if post2.tags contains tag1 %}
              {%- assign common_tag_count = common_tag_count | plus: 1 -%}
            {% endif %}
          {% endfor %}

          {% if common_tag_count > 0 %}
            {%- capture edge_json -%}
              {
                "from": "{{ post1.url | relative_url }}",
                "to": "{{ post2.url | relative_url }}",
                "value": {{ common_tag_count }}
              }
            {%- endcapture -%}
            {%- assign edges_list = edges_list | append: edge_json | append: "," -%}
          {% endif %}
        {% endif %}
      {% endfor %}
    {% endfor %}
    {{ edges_list | remove_last: "," }}
  ]
}
